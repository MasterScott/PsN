\input{inputs/format_header.tex}
\guidetitle{Developer's guide}
\usepackage{hyperref}

\begin{document}

\maketitle

  
\section{Introduction}

This document is intended for PsN developers. It is work in progress.

\section{Build environment}
The documentation is made in \LaTeX and pdfs can be generated with \verb|make doc|. The
packages texlive-extra-util and texlive-science are needed to build all documents.

\section{Revision control}
PsN use git as revision control system. This chapter give some best practices.

\subsection{Tagging}
All releases of PsN should be tagged with its version number with an annotated tag. Remember
that tags need to be pushed separately.
\begin{verbatim}
git tag -a 4.0.0 - m "My tag message"
git push origin --tags
\end{verbatim}

\section{Style guide}

\subsection{Methods}

\subsubsection{Parameter validation}
All methods should validate their parameters with validated\_hash in MooseX::Params::Validate

\begin{verbatim}
use MooseX::Params::Validate;

sub my_method
{
  my ($self, %parm) = validated_hash(@_,
    parameter1 => { isa => 'Str', optional => 0 },
    parameter2 => { isa => 'Num', default => '28' },
  );

  # ...
}
\end{verbatim}

See the MooseX::Params::Validate documentation \cite{params} and Moose::Types documentation \cite{types} for more information.

Remember to turn off the parameter caching if you give default values that can vary between calls.

\begin{verbatim}
my ($self, %parm) = validated_hash(@_,
  parameter1 => { isa => 'Str', optional => 0 },
  parameter2 => { isa => 'Num', default => $self->some_method },
  MX_PARAMS_VALIDATE_NO_CACHE => 1
);
\end{verbatim}

\subsubsection{Private methods}

Names of private methods should start with an underscore.
\begin{verbatim}
sub _this_is_a_private_method
{

}
\end{verbatim}


\subsection{Attributes}
triggers should be named \_attribute\_set
\begin{verbatim}
has 'filename' => (is => 'rw', isa => 'Str', trigger => \&_filename_set );

sub _filename_set
{
  my $self = shift;
  my $parm = shift;
  my $old_parm = shift;

	if ($parm ne $old_parm) {
    print "We are changing the filename!\n";
  }
}
\end{verbatim}

clearers should be named clear\_attribute
\begin{verbatim}
has 'filenames' => (is => 'rw', isa => 'ArrayRef[Str]', clearer => 'clear_filenames' );

if ($need_to_delete) {
  $self->clear_filenames;
}
\end{verbatim}

predicates should be named has\_attribute
\begin{verbatim}
has 'filename' => (is => 'rw', isa => 'Str', predicate => 'has_filename' );

if ($self->has_filename) {
  print "The filename attribute exists\n";
}
\end{verbatim}

don't use parentheses for getters
\begin{verbatim}
  if ($self->filename eq 'my_file') {
    print "Is my_file\n";
  }
\end{verbatim}

\begin{thebibliography}{1}
	\bibitem{params} {\em MooseX::Params::Validate}, \url{http://search.cpan.org/\~drolsky/MooseX-Params-Validate-0.18/lib/MooseX/Params/Validate.pm}, CPAN
	\bibitem{types} {\em Moose::Manual::Types}, \url{http://search.cpan.org/~ether/Moose-2.1005/lib/Moose/Manual/Types.pod}, CPAN
\end{thebibliography}


\end{document}

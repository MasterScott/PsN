\input{inputs/format_header.tex}
\guidetitle{PsN installation}{2015-03-05}
\begin{document}

\maketitle

\section{Required software}
Before you install PsN, you should make sure that the following programs are installed on your computer:
\begin{itemize}
\item NONMEM 

If you intend to run PsN4 with NMQual8 you should leave the xml file as is. No changes at all should be made.
This is new compared to PsN3, where some changes were necessary.
	\item Perl5 version 5.10.1 or higher. NOTE: If you are using ActivePerl you need at least version 5.16.
	\item Perl modules Math::Random, Statistics::Distributions, Moose, MooseX::Params::Validate, Archive::Zip and File::Copy::Recursive (installation instructions below). PsN can be run without Statistics::Distributions, Archive::Zip and File::Copy::Recursive but some scm and vpc features and a scm bugfix will not be available.
\end{itemize}

\section{Verify that you NONMEM installation works properly}
\begin{enumerate}
\item Make sure that you can run NONMEM directly via the nmfe script (or with NMQual). If this does not work then it will not work via PsN either.
\item If you intend to run NONMEM in parallel then you must make sure you can do it directly via the nmfe script. If this does not work then it will not work via PsN either.
\end{enumerate}

\section{Install required Perl modules}
PsN requires the Perl modules Math::Random, Moose and MooseX::Params::Validate to be installed on your computer. Some other modules are very useful, but not absolutely required. The XML::LibXML module is only needed if using the nmoutput2so script or the option -standardised\_output. The following paragraphs describe the setup procedure for different operating systems. For this procedure to work you must be connected to the internet, because the package is downloaded from the web. Pay attention to any warning messages that talk about internet connection problems, such problems must be solved before doing the installations.

\subsection{Windows (Strawberry perl)}
Open a command window (cmd) and run the following commands:

\begin{verbatim}
cpan Math::Random
cpan Statistics::Distributions
cpan MooseX::Params::Validate
cpan XML::LibXML
\end{verbatim}


\subsection{Windows (ActivePerl)}

Open a command window (cmd) and run the commands (press Enter after each command):
\begin{verbatim}
ppm install math-random
ppm install moosex-params-validate
ppm install statistics-distributions
ppm install archive-zip
ppm install file-copy-recursive
ppm install XML-LibXML
\end{verbatim}


\subsection{Linux}

Start a command window and run the following commands (hit Enter after each command), prepend sudo if necessary:
\begin{verbatim}
cpan Math::Random
cpan Moose
cpan MooseX::Params::Validate
cpan Statistics::Distributions
cpan Archive::Zip
cpan File::Copy::Recursive
cpan Storable
cpan XML::LibXML
\end{verbatim}

\section{Run the PsN installation script}

\begin{enumerate}
\item Unpack the file you downloaded from psn.sourceforge.net. It will create a directory called PsN-Source.
\item Run the installation script from within PsN-Source. If you are running windows and have ActiveState ActivePerl installed you should be able to double-click on setup.pl. Otherwise open a command line window (Windows Start-$>$Run, type 'cmd'), go to the PsN-Source directory and type: 
\begin{verbatim}
perl setup.pl
\end{verbatim}
Unix users should open their favorite terminal, go to the PsN-Source directory and type:
\begin{verbatim}
perl setup.pl
\end{verbatim}
\item Answer the questions on screen. The default is probably the best for most users. It is really, really recommended to let the script generate psn.conf for you, unless you are experienced in installing and configuring PsN.
If you cannot install PsN where the install script suggests and you wish to use PsN in your own perl scripts, you must make sure that the directory where you installed the PsN core and toolkit is in Perl's include path. For convenience you should also check that the directory where the utilities are installed is in your search path. 
\item If you did not let the installation script create a configuration file psn.conf for you, or if you are running NONMEM via NMQual or on a cluster, you need to edit psn.conf in the PsN installation directory (only a very minor change for NMQual). The document psn\_configuration.pdf in PsN-Source/doc describes how to make correct settings in the psn.conf file. The help document is also found on the PsN website under Documentation.
\item When the installation is done you can safely remove the PsN-Source directory if you like. 
\end{enumerate}

\section{Portable PsN installations}
This functionality is intended for advanced users only. The setup.pl script
takes an optional argument 'relative':
\begin{verbatim}
setup.pl relative
\end{verbatim}
If this argument is given, the bin scripts (PsN Utilities) 
will use a relative instead of 
absolute path when
including the lib modules (PsN Core and Toolkit). 
This makes the PsN installation directory movable,
as long as the relative position between the bin scripts and lib modules
remains the same. In addition the
\begin{verbatim}
[nm_versions]
\end{verbatim}
section in psn.conf can list the name of the nmfe executables instead of
the full path to the NONMEM installation directories 
\emph{if at runtime}
the nmfe executable, chosen by default or with option -nm\_version,
is in the user \$PATH, 
see documentation in psn\_configuration.pdf.
\section{Multiple PsN installations}
It is possible to have several installations of PsN and use them in parallel. 
The default version of PsN may be changed every time a new installation is made. 
To check which version is the default use command
\begin{verbatim}
psn -version
\end{verbatim}

\noindent A specific version may be called with its version number, for example

\begin{verbatim}
execute-3.7.6  -help 
\end{verbatim}

\noindent Note: When installing PsN4 on Windows all previously installed versions 
(installed with the same bin directory,
including PsN3-versions) are fixed automatically so that they are callable with a specific version as 
explained above. This is a new feature of PsN4 when installing on Windows.

\end{document}

\input{inputs/format_header.tex}
\guidetitle{QA user guide}{2017-06-21}

\begin{document}

\maketitle
\newcommand{\guidetoolname}{qa}


\section{Overview}
Quality assurance (qa) is a tool to assess the quality of a final model. The analysis is not done directly on the final model, but on certain model proxies to speed up the analysis time. The proxies include a linearized version of the final model and modelling on the residual error.

Example
\begin{verbatim}
qa pheno.mod -parameters=CL,V -covariates=WGT,APGR
\end{verbatim}

\section{Input and options}

\subsection{Required input}
A model file is required on the command-line.



\subsection{Optional input}



\begin{optionlist}
\optname{categorical}
A comma separated list of categorical covariates
\nextopt
\optname{covariates}
A comma separated list of continuous covariates
\nextopt
\optname{dv}{CWRES}
Name of the dependent variable for the structural and residual model analysis. CWRES is default.
\nextopt
\optname{dvid}{DVID}
Name of the dvid column. DVID is default.
Will only be used for the structural and residual model analysis.
\nextopt
\optname{fo}
Set if the FO method should be used for all estimations
of the linearized model. Default is off.
\nextopt
\optname{groups}{10}
Set the number of groups to use for the time varying models.
Quantiles using this number will be calculated.
The default is 10.
\nextopt
\optdefault{idv}{TIME}
Name of the independent variable for the structural and residual model analysis.
Default is to use TIME,PRED and TAD (if present). This option will change the name
of TIME.
\nextopt
\optname{lst\_file}
Set a NONMEM output file to be used for initial estimates.
Default is to use an lst-file with the same name as the model.
\nextopt
\optdefault{occ}{OCC}
Name of the occasion column. OCC is default.
The IOV functionality is not yet implemented.
\nextopt
\optname{parameters}
A comma separated list of parameters
\nextopt
    \optname{nointer}
        Don't use interaction. Default is off.
    \nextopt
\end{optionlist}

\section{Known limitations and problems}

Some limitations and problems will affect the ability to generate any output, other will impact one or some of the different evaluations, but still result in an output report. 

\subsection{General limitations and problems}
\begin{itemize}
	\item There is no support in qa for categorical data, including handling censored continuous data using the M3/M4 likelihood-based methods
	\item There is no support in qa for the first-order (FO) method. Testing with FOCE(I) has been extensive, and sparse with other methods (LAPLACE, SAEM, ITS, IMP and IMPMAP). BAYES has not been tested. 
	\item With linearization and eta-epsilon interaction (INTER) individual estimates of empirical Bayes estimates (EBE) of parameters may end up in local minima. The most prominent sign of this is that differences in OFV between two models have a sign, different from that expected, i.e. a smaller model may have a lower OFV than a full model. One experimental remedy is to rerun the qa script with the option \verb|-nointer|, which will omit an update of the interaction terms in the linearization calculations.
	\item Multiple variables, through the option \verb|-dvid|, is not yet implemented in the report although the relevant models are being estimated.
	\item Automatic addition of interoccasion variability, implemented via \verb|-iov| is not yet functional.
	\item Only parameters associated with an ETA can be used in the \verb|-parameter=| option
    \item All covariates must be available in the dataset and declared in \$INPUT
    \item Missing values for covariates must be coded using -99
\end{itemize}

\subsection{SCM}
\begin{itemize}
	\item The SCM requires parameters defined in \verb|-parameter=P| to be associated with the corresponding ETA in the format P=f(ETA(x)), i.e. where the ETA is on the left-hand side of the equation defining the parameter. Parameters need to be defined in \$PK or \$PRED, not \$ERROR.

	\item There is no support in the QA version of SCM to handle multi-category covariates. A work-around is to define them as either continuous or as multiple bivariate covariates. The latter would require changes to the dataset. Naturally the QA investigation could be made more focused by not including these covariates in the evaluation by omitting them in the \verb|-categorical| option.
\end{itemize}

\subsection{FREM}
\begin{itemize}
	\item For time-varying covariates, only the baseline value will be used.
	\item For multiple categorical covariates, missing combinations may make the model unstable. Such aan example would be the bivariate covariates SEX and GENOTYPE, with the category female-PM missing.
	\item A fixed omega is not allowed in the model if there are non-fixed omegas both before and after it
\end{itemize}


\section{Results}

The main result file is the PsN\_qa\_plots.pdf that will collect all tables and plots of interest

\references

\end{document}

26/08/2015 
11:03
; Script generated by the pharmML2Nmtran Converter v.0.1.0
; Source	: PharmML 0.6.0
; Target	: NMTRAN 7.3.0
; Model 	: UseCase1
; Dated 	: Wed Aug 26 11:03:25 BST 2015

$PROBLEM "UseCase1.mdl - generated by MDL2PharmML v.6.0"

$INPUT  ID TIME WT=DROP AMT DVID DV MDV LOGTWT
$DATA "warfarin_conc.csv" IGNORE=@
$SUBS ADVAN13 TOL=9

$MODEL 
COMP (COMP1) 	;GUT
COMP (COMP2) 	;CENTRAL

$PK 
POP_CL = THETA(1)
POP_V = THETA(2)
POP_KA = THETA(3)
POP_TLAG = THETA(4)
RUV_PROP = THETA(5)
RUV_ADD = THETA(6)
BETA_CL_WT = THETA(7)
BETA_V_WT = THETA(8)

ETA_CL = ETA(1)
ETA_V = ETA(2)
ETA_KA = ETA(3)
ETA_TLAG = ETA(4)


MU_1 = LOG(POP_CL)+BETA_CL_WT * LOGTWT;
CL = EXP(MU_1 + ETA(1));

MU_2 = LOG(POP_V)+BETA_V_WT * LOGTWT;
V = EXP(MU_2 + ETA(2));

MU_3 = LOG(POP_KA);
KA = EXP(MU_3 + ETA(3));

MU_4 = LOG(POP_TLAG);
TLAG = EXP(MU_4 + ETA(4));

A_0(1) = 0
A_0(2) = 0

$DES 
GUT_DES = A(1)
CENTRAL_DES = A(2)
IF (T.GE.TLAG) THEN
	RATEIN_DES = GUT_DES*KA 
ELSE
	RATEIN_DES = 0 
ENDIF
CC_DES = CENTRAL_DES/V
DADT(1) = -(RATEIN_DES)
DADT(2) = (RATEIN_DES-CL*CENTRAL_DES/V)

$ERROR 
GUT = A(1)
CENTRAL = A(2)
IF (TIME.GE.TLAG) THEN
	RATEIN = GUT*KA 
ELSE
	RATEIN = 0 
ENDIF
CC = CENTRAL/V
IPRED = CC
W = RUV_ADD+RUV_PROP*IPRED
Y = IPRED+W*EPS(1)
IRES = DV - IPRED
IWRES = IRES/W

$THETA 
( 0.001 , 0.1 )	;POP_CL
( 0.001 , 8.0 )	;POP_V
( 0.001 , 0.362 )	;POP_KA
( 0.001 , 1.0 )	;POP_TLAG
( 0.0 , 0.1 )	;RUV_PROP
( 0.0 , 0.1 )	;RUV_ADD
(0.75  FIX )	;BETA_CL_WT
(1.0  FIX )	;BETA_V_WT

$OMEGA BLOCK(2) CORRELATION SD
(0.1 )	;PPV_CL
(0.01 )	;PPV_CL_PPV_V
(0.1 )	;PPV_V

$OMEGA 
(0.1 SD )	;PPV_KA
(0.1  FIX SD )	;PPV_TLAG

$SIGMA 
1.0 FIX

$EST METHOD=SAEM AUTO=1 PRINT=100


$TABLE  ID TIME AMT DVID MDV LOGTWT PRED IPRED RES IRES WRES IWRES Y DV NOAPPEND NOPRINT FILE=sdtab

$TABLE  ID CL V KA TLAG ETA_CL ETA_V ETA_KA ETA_TLAG NOAPPEND NOPRINT FILE=patab

$TABLE  ID LOGTWT NOAPPEND NOPRINT FILE=cotab


  
NM-TRAN MESSAGES 
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.
             
 (WARNING  121) INTERACTION IS IMPLIED WITH EM/BAYES ESTIMATION METHODS

 (MU_WARNING 26) DATA ITEM(S) USED IN DEFINITION OF MU_(S) SHOULD BE CONSTANT FOR INDIV. REC.:
  LOGTWT
  
License Registered to: Mango Business Solutions Ltd
Expiration Date:    14 OCT 2015
Current Date:       26 AUG 2015
Days until program expires :  48
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.3.0
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.

 PROBLEM NO.:         1
 "UseCase1.mdl - generated by MDL2PharmML v.6.0"
0DATA CHECKOUT RUN:              NO
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO
 NO. OF DATA RECS IN DATA SET:      288
 NO. OF DATA ITEMS IN DATA SET:   8
 ID DATA ITEM IS DATA ITEM NO.:   1
 DEP VARIABLE IS DATA ITEM NO.:   5
 MDV DATA ITEM IS DATA ITEM NO.:  6
0INDICES PASSED TO SUBROUTINE PRED:
   8   2   3   0   0   0   0   0   0   0   0
0LABELS FOR DATA ITEMS:
 ID TIME AMT DVID DV MDV LOGTWT EVID
0(NONBLANK) LABELS FOR PRED-DEFINED ITEMS:
 ETA_CL ETA_V ETA_KA ETA_TLAG CL V KA TLAG IPRED Y IRES IWRES
0FORMAT FOR DATA:
 (E3.0,E4.0,E5.0,E2.0,E5.0,E2.0,E13.0,1F2.0)

 TOT. NO. OF OBS RECS:      250
 TOT. NO. OF INDIVIDUALS:     32
0LENGTH OF THETA:   8
0DEFAULT THETA BOUNDARY TEST OMITTED:    NO
0OMEGA HAS BLOCK FORM:
  1
  1  1
  0  0  2
  0  0  0  3
0DEFAULT OMEGA BOUNDARY TEST OMITTED:    NO
0SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   1
0DEFAULT SIGMA BOUNDARY TEST OMITTED:    NO
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
  0.1000E-02     0.1000E+00     0.1000E+07
  0.1000E-02     0.8000E+01     0.1000E+07
  0.1000E-02     0.3620E+00     0.1000E+07
  0.1000E-02     0.1000E+01     0.1000E+07
  0.0000E+00     0.1000E+00     0.1000E+07
  0.0000E+00     0.1000E+00     0.1000E+07
  0.7500E+00     0.7500E+00     0.7500E+00
  0.1000E+01     0.1000E+01     0.1000E+01
0INITIAL ESTIMATE OF OMEGA:
 BLOCK SET NO.   BLOCK                                                                    FIXED
        1                                                                                   NO
                  0.1000E-01
                  0.1000E-03   0.1000E-01
        2                                                                                   NO
                  0.1000E-01
        3                                                                                  YES
                  0.1000E-01
0INITIAL ESTIMATE OF SIGMA:
 0.1000E+01
0SIGMA CONSTRAINED TO BE THIS INITIAL ESTIMATE
0TABLES STEP OMITTED:    NO
 NO. OF TABLES:           3
 SEED NUMBER (SEED):    11456
 RANMETHOD:
 MC SAMPLES (ESEED):    300
 WRES SQUARE ROOT TYPE:            EIGENVALUE
0-- TABLE   1 --
04 COLUMNS APPENDED:     NO
 PRINTED:                NO
 HEADER:                YES
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 LFORMAT:
 RFORMAT:
0USER-CHOSEN ITEMS:
 ID TIME AMT DVID MDV LOGTWT PRED IPRED RES IRES WRES IWRES Y DV
0-- TABLE   2 --
04 COLUMNS APPENDED:     NO
 PRINTED:                NO
 HEADER:                YES
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 LFORMAT:
 RFORMAT:
0USER-CHOSEN ITEMS:
 ID CL V KA TLAG ETA_CL ETA_V ETA_KA ETA_TLAG
0-- TABLE   3 --
04 COLUMNS APPENDED:     NO
 PRINTED:                NO
 HEADER:                YES
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 LFORMAT:
 RFORMAT:
0USER-CHOSEN ITEMS:
 ID LOGTWT
1DOUBLE PRECISION PREDPP VERSION 7.3.0

 GENERAL NONLINEAR KINETICS MODEL USING LSODA (ADVAN13)
0MODEL SUBROUTINE USER-SUPPLIED - ID NO. 9999
0MAXIMUM NO. OF BASIC PK PARAMETERS:   4
0COMPARTMENT ATTRIBUTES
 COMPT. NO.   FUNCTION   INITIAL    ON/OFF      DOSE      DEFAULT    DEFAULT
                         STATUS     ALLOWED    ALLOWED    FOR DOSE   FOR OBS.
    1         COMP1        ON         YES        YES        YES        YES
    2         COMP2        ON         YES        YES        NO         NO
    3         OUTPUT       OFF        YES        NO         NO         NO
0NRD VALUE(S) FROM SUBROUTINE TOL:   9
1
 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG
 COMPT. NO.                             INDICES
              SCALE      BIOAVAIL.   ZERO-ORDER  ZERO-ORDER  ABSORB
                         FRACTION    RATE        DURATION    LAG
    1            *           *           *           *           *
    2            *           *           *           *           *
    3            *           -           -           -           -
             - PARAMETER IS NOT ALLOWED FOR THIS MODEL
             * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;
               WILL DEFAULT TO ONE IF APPLICABLE
0DATA ITEM INDICES USED BY PRED ARE:
   EVENT ID DATA ITEM IS DATA ITEM NO.:      8
   TIME DATA ITEM IS DATA ITEM NO.:          2
   DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:   3

0PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.
 PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES.
0PK SUBROUTINE INDICATES THAT COMPARTMENT AMOUNTS ARE INITIALIZED.
0ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.
0ERROR SUBROUTINE INDICATES THAT DERIVATIVES OF COMPARTMENT AMOUNTS ARE USED.
0DES SUBROUTINE USES FULL STORAGE MODE.
1


 #TBLN:      1
 #METH: Stochastic Approximation Expectation-Maximization (No Prior)

 ESTIMATION STEP OMITTED:                 NO  
 ANALYSIS TYPE:                           POPULATION
 CONDITIONAL ESTIMATES USED:              YES 
 CENTERED ETA:                            NO  
 EPS-ETA INTERACTION:                     YES 
 LAPLACIAN OBJ. FUNC.:                    NO  
 NO. OF FUNCT. EVALS. ALLOWED:            960
 NO. OF SIG. FIGURES REQUIRED:            3
 INTERMEDIATE PRINTOUT:                   YES 
 ESTIMATE OUTPUT TO MSF:                  NO  
 IND. OBJ. FUNC. VALUES SORTED:           NO  
 NUMERICAL DERIVATIVE 
       FILE REQUEST (NUMDER):             NONE
 MAP (ETAHAT) ESTIMATION METHOD (OPTMAP): 0           
 ETA HESSIAN EVALUATION METHOD (ETADER):  0           
 INITIAL ETA FOR MAP ESTIMATION (MCETA):  0           
 SIGDIGITS FOR MAP ESTIMATION (SIGLO):    100         
 GRADIENT SIGDIGITS OF 
       FIXED EFFECTS PARAMETERS (SIGL):   100         
 EXCLUDE TITLE (NOTITLE):                 NO 
 EXCLUDE COLUMN LABELS (NOLABEL):         NO 
 NOPRIOR SETTING (NOPRIOR):               ON 
 NOCOV SETTING (NOCOV):                   OFF
 DERCONT SETTING (DERCONT):               OFF
 ABSOLUTE TOLERANCE-ADVAN 9,13 ONLY(ATOL):-100        
 FINAL ETA RE-EVALUATION (FNLETA):        ON 
 EXCLUDE NON-INFLUENTIAL (NON-INFL.) ETAS 
       IN SHRINKAGE (ETASTYPE):           NO 
 NON-INFL. ETA CORRECTION (NONINFETA):    OFF
 FORMAT FOR ADDITIONAL FILES (FORMAT):    S1PE12.5
 PARAMETER ORDER FOR OUTPUTS (ORDER):     TSOL
 EM OR BAYESIAN METHOD USED:              STOCHASTIC APPROXIMATION EXPECTATION MAXIMIZATION (SAEM)
 MU MODELING PATTERN (MUM):               
 GRADIENT/GIBBS PATTERN (GRD):            
 AUTOMATIC SETTING FEATURE (AUTO):        ON 
 CONVERGENCE TYPE (CTYPE):                3           
 CONVERGENCE INTERVAL (CINTERVAL):        0           
 CONVERGENCE ITERATIONS (CITER):          10          
 CONVERGENCE ALPHA ERROR (CALPHA):        5.000000000000000E-02   
 BURN-IN ITERATIONS (NBURN):              4000        
 ITERATIONS (NITER):                      1000        
 ANEAL SETTING (CONSTRAIN):               1           
 STARTING SEED FOR MC METHODS (SEED):     11456       
 MC SAMPLES PER SUBJECT (ISAMPLE):        2           
 MAXIMUM SAMPLES PER SUBJECT FOR AUTOMATIC
 ISAMPLE ADJUSTMENT (ISAMPEND):           10          
 RANDOM SAMPLING METHOD (RANMETHOD):      
 EXPECTATION ONLY (EONLY):                NO 
 PROPOSAL DENSITY SCALING RANGE 
              (ISCALE_MIN, ISCALE_MAX):   1.000000000000000E-06   ,1000000.00000000        
 SAMPLE ACCEPTANCE RATE (IACCEPT):        0.400000000000000       
 METROPOLIS HASTINGS SAMPLING FOR INDIVIDUAL ETAS:
 SAMPLES FOR GLOBAL SEARCH KERNEL (ISAMPLE_M1):          2           
 SAMPLES FOR NEIGHBOR SEARCH KERNEL (ISAMPLE_M1A):       0           
 SAMPLES FOR LOCAL SEARCH KERNEL (ISAMPLE_M2):           2           
 SAMPLES FOR LOCAL UNIVARIATE KERNEL (ISAMPLE_M3):       2           


 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=PREDI
 RES=RESI
 WRES=WRESI
 IWRS=IWRESI
 IPRD=IPREDI
 IRS=IRESI

 EM/BAYES SETUP:
 THETAS THAT ARE MU MODELED:
   1   2   3   4
 THETAS THAT ARE SIGMA-LIKE:
 

 MONITORING OF SEARCH:

 ISAMPLE PreProcessing
 iteration         -200  SAEMOBJ=   1929.4083286315213
 iteration         -100  SAEMOBJ=  -455.60177934766756
 Stochastic/Burn-in Mode
 iteration        -4000  SAEMOBJ=  -410.60739359375395
 iteration        -3900  SAEMOBJ=  -246.99366873319542
 iteration        -3800  SAEMOBJ=  -248.05929362048602
 iteration        -3700  SAEMOBJ=  -249.10305075947559
 iteration        -3600  SAEMOBJ=  -265.03229648602820
 iteration        -3500  SAEMOBJ=  -240.40120445039719
 iteration        -3400  SAEMOBJ=  -258.66049963454066
 iteration        -3300  SAEMOBJ=  -249.28528311059662
 iteration        -3200  SAEMOBJ=  -249.77386278532751
 iteration        -3100  SAEMOBJ=  -250.19870545967612
 iteration        -3000  SAEMOBJ=  -265.00187117108680
 iteration        -2900  SAEMOBJ=  -259.96617145522822
 iteration        -2800  SAEMOBJ=  -262.52224902369312
 iteration        -2700  SAEMOBJ=  -259.07792011805992
 iteration        -2600  SAEMOBJ=  -255.37411349272401
 iteration        -2500  SAEMOBJ=  -255.18798837306909
 iteration        -2400  SAEMOBJ=  -254.91727316684791
 iteration        -2300  SAEMOBJ=  -259.31051620040199
 iteration        -2200  SAEMOBJ=  -262.29017396312088
 iteration        -2100  SAEMOBJ=  -258.15475569911536
 iteration        -2000  SAEMOBJ=  -245.48410019464689
 iteration        -1900  SAEMOBJ=  -253.52365680895710
 iteration        -1800  SAEMOBJ=  -235.93071182377935
 iteration        -1700  SAEMOBJ=  -259.18182905283231
 iteration        -1600  SAEMOBJ=  -254.76358469912407
 iteration        -1500  SAEMOBJ=  -246.80462206435257
 iteration        -1400  SAEMOBJ=  -243.23064501737997
 iteration        -1300  SAEMOBJ=  -248.40644671303883
 iteration        -1200  SAEMOBJ=  -253.89078556352518
 iteration        -1100  SAEMOBJ=  -244.76933914942830
 iteration        -1000  SAEMOBJ=  -245.98554500209562
 iteration         -900  SAEMOBJ=  -241.26583929093479
 iteration         -800  SAEMOBJ=  -252.21636130163324
 iteration         -700  SAEMOBJ=  -252.09869110583412
 iteration         -600  SAEMOBJ=  -250.85809670100127
 iteration         -500  SAEMOBJ=  -248.35130538467916
 iteration         -400  SAEMOBJ=  -239.94613369609223
 iteration         -300  SAEMOBJ=  -256.41641199862272
 iteration         -200  SAEMOBJ=  -249.23359032783466
 iteration         -100  SAEMOBJ=  -232.39395979838534
 Reduced Stochastic/Accumulation Mode
 iteration            0  SAEMOBJ=  -473.00956393280291
 iteration          100  SAEMOBJ=  -509.22563539401523
 iteration          200  SAEMOBJ=  -513.69573969264945
 iteration          300  SAEMOBJ=  -517.31640928057357
 iteration          400  SAEMOBJ=  -519.30471185050840
 iteration          500  SAEMOBJ=  -521.39512810774306
 iteration          600  SAEMOBJ=  -522.42375191197868
 iteration          700  SAEMOBJ=  -523.84035755400396
 iteration          800  SAEMOBJ=  -525.02206204012566
 iteration          900  SAEMOBJ=  -526.20402045160392
 iteration         1000  SAEMOBJ=  -526.79264468591452

 #TERM:
 STOCHASTIC PORTION WAS NOT TESTED FOR CONVERGENCE
 REDUCED STOCHASTIC PORTION WAS COMPLETED

 ETABAR IS THE ARITHMETIC MEAN OF THE ETA-ESTIMATES,
 AND THE P-VALUE IS GIVEN FOR THE NULL HYPOTHESIS THAT THE TRUE MEAN IS 0.

 ETABAR:         5.6106E-06 -4.2957E-06 -4.1354E-05 -9.2107E-08
 SE:             4.4652E-02  2.0951E-02  7.5243E-02  1.5755E-02
 N:                      32          32          32          32

 P VAL.:         9.9990E-01  9.9984E-01  9.9956E-01  1.0000E+00

 ETAshrink(%):   1.5349E+00  1.2847E+01  4.7200E+01  9.4501E+00
 EBVshrink(%):   1.5322E+00  1.2850E+01  4.7211E+01  6.5306E+01
 EPSshrink(%):   2.1772E+00

 #TERE:
 Elapsed estimation time in seconds:  3327.00
1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************           STOCHASTIC APPROXIMATION EXPECTATION-MAXIMIZATION (NO PRIOR)         ********************
 #OBJT:**************                        FINAL VALUE OF LIKELIHOOD FUNCTION                      ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 





 #OBJV:********************************************     -526.793       **************************************************
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************           STOCHASTIC APPROXIMATION EXPECTATION-MAXIMIZATION (NO PRIOR)         ********************
 ********************                             FINAL PARAMETER ESTIMATE                           ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 


 THETA - VECTOR OF FIXED EFFECTS PARAMETERS   *********


         TH 1      TH 2      TH 3      TH 4      TH 5      TH 6      TH 7      TH 8     
 
         1.33E-01  8.18E+00  1.79E+00  9.79E-01  1.08E-01  4.42E-17  7.50E-01  1.00E+00
 


 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS  ********


            ETA1      ETA2      ETA3      ETA4   
 
 ETA1
+        6.79E-02
 
 ETA2
+        1.25E-02  1.91E-02
 
 ETA3
+        0.00E+00  0.00E+00  6.71E-01
 
 ETA4
+        0.00E+00  0.00E+00  0.00E+00  1.00E-02
 


 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS  ****


            EPS1   
 
 EPS1
+        1.00E+00
 
1


 OMEGA - CORR MATRIX FOR RANDOM EFFECTS - ETAS  *******


            ETA1      ETA2      ETA3      ETA4   
 
 ETA1
+        2.61E-01
 
 ETA2
+        3.47E-01  1.38E-01
 
 ETA3
+        0.00E+00  0.00E+00  8.19E-01
 
 ETA4
+        0.00E+00  0.00E+00  0.00E+00  1.00E-01
 


 SIGMA - CORR MATRIX FOR RANDOM EFFECTS - EPSILONS  ***


            EPS1   
 
 EPS1
+        1.00E+00
 
 #CPUT: Total CPU Time in Seconds,     3294.460
Stop Time: 
26/08/2015 
11:59

;; 1. Based on: 1
$SIZES      PD=-58
$PROBLEM    PKPD joint FPG HBA1C 20070724
$INPUT      ID DV MDV OPRED D_EPS1 TIME AMT RATE CMT CLI VI DOSE AGE
            WGT SEX LBW CRCO EVID PRET ORIG D_ETA1 D_ETA2 D_ETA3
            D_ETA4 D_ETA5 D_ETA6 D_ETA7 D_ETA8 D_ETA9 OETA1 OETA2
            OETA3 OETA4 OETA5 OETA6 OETA7 OETA8 OETA9 D_EPSETA1_1
            D_EPSETA1_2 D_EPSETA1_3 D_EPSETA1_4 D_EPSETA1_5
            D_EPSETA1_6 D_EPSETA1_7 D_EPSETA1_8 D_EPSETA1_9 FREMTYPE
$DATA      ../frem_dataset.dta IGNORE=@

;  simultaneous analysis of FPG-Hb-HbA1c
$ABBREVIATED DERIV2=NOCOMMON
$PRED  
;;;FREM CODE BEGIN
     BSV_AGE = ETA(10)*10.2318688078
     BSV_WGT = ETA(11)*17.738664519
     BSV_LBW = ETA(12)*11.2023916302
     BSV_CRCO = ETA(13)*20.6542819724
     BSV_SEX = ETA(14)*0.492904320263
     TV_AGE=THETA(1)
     TV_WGT=THETA(2)
     TV_LBW=THETA(3)
     TV_CRCO=THETA(4)
     TV_SEX=THETA(5)
;;;FREM CODE END
 BASE1=D_ETA1*(ETA(4)-OETA1)
BASE2=D_ETA2*(ETA(5)-OETA2)
BASE3=D_ETA3*(ETA(6)-OETA3)
BASE4=D_ETA4*(ETA(1)-OETA4)
BASE5=D_ETA5*(ETA(2)-OETA5)
BASE6=D_ETA6*(ETA(7)-OETA6)
BASE7=D_ETA7*(ETA(8)-OETA7)
BASE8=D_ETA8*(ETA(9)-OETA8)
BASE9=D_ETA9*(ETA(3)-OETA9)
BSUM1=BASE1+BASE2+BASE3+BASE4+BASE5+BASE6+BASE7+BASE8+BASE9
BASE_TERMS=BSUM1
IPRED=OPRED+BASE_TERMS
ERR1=EPS(1)*(D_EPS1+D_EPSETA1_1*(ETA(4)-OETA1))
ERR2=EPS(1)*(D_EPSETA1_2*(ETA(5)-OETA2))
ERR3=EPS(1)*(D_EPSETA1_3*(ETA(6)-OETA3))
ERR4=EPS(1)*(D_EPSETA1_4*(ETA(1)-OETA4))
ERR5=EPS(1)*(D_EPSETA1_5*(ETA(2)-OETA5))
ERR6=EPS(1)*(D_EPSETA1_6*(ETA(7)-OETA6))
ERR7=EPS(1)*(D_EPSETA1_7*(ETA(8)-OETA7))
ERR8=EPS(1)*(D_EPSETA1_8*(ETA(9)-OETA8))
ERR9=EPS(1)*(D_EPSETA1_9*(ETA(3)-OETA9))
ESUM1=ERR1+ERR2+ERR3+ERR4+ERR5+ERR6+ERR7+ERR8+ERR9
ERROR_TERMS=ESUM1
Y=IPRED+ERROR_TERMS
;;;FREM CODE BEGIN
     Y_AGE = TV_AGE + BSV_AGE
     Y_WGT = TV_WGT + BSV_WGT
     Y_LBW = TV_LBW + BSV_LBW
     Y_CRCO = TV_CRCO + BSV_CRCO
     Y_SEX = TV_SEX + BSV_SEX
     IF (FREMTYPE.EQ.100) THEN
        Y = Y_AGE+EPS(2)
        IPRED = Y_AGE
     END IF
     IF (FREMTYPE.EQ.200) THEN
        Y = Y_WGT+EPS(2)
        IPRED = Y_WGT
     END IF
     IF (FREMTYPE.EQ.300) THEN
        Y = Y_LBW+EPS(2)
        IPRED = Y_LBW
     END IF
     IF (FREMTYPE.EQ.400) THEN
        Y = Y_CRCO+EPS(2)
        IPRED = Y_CRCO
     END IF
     IF (FREMTYPE.EQ.500) THEN
        Y = Y_SEX+EPS(2)
        IPRED = Y_SEX
     END IF
;;;FREM CODE END
$THETA  57.1553398058 FIX ; TV_AGE
 88.9502427184 FIX ; TV_WGT
 58.4322815534 FIX ; TV_LBW
 69.5191747573 FIX ; TV_CRCO
 1.41262135922 FIX ; TV_SEX
$OMEGA  BLOCK(1)
 0.0553028  ; 4 RES HBA1c
$OMEGA  BLOCK(1)
 0.0269513  ;   5 RES Hb
$OMEGA  BLOCK(1)
 0.0948142  ;  9 RES FPG
$OMEGA  BLOCK(11)
 0.00354177  ;      1 GAM
 1E-07 0.0069065  ;     2 KINH
 1E-07 1E-07 0.340141  ;     3 HB50
 1E-07 1E-07 1E-07 0.0183344  ; 6 FPG BASELINE
 1E-07 1E-07 1E-07 1E-07 0.981616  ; 7 EC50 FPG
 1E-07 1E-07 1E-07 1E-07 1E-07 0.622261  ;  8 PBO FPG
 0.00386264 -0.0145581 -0.239367 -0.0298749 -0.117254 0.0391603 0.997377  ;    BSV_AGE
 -0.0203792 0.0117776 0.0185413 -0.0030641 -0.0643184 -0.0658672 -0.194617 0.997908  ;    BSV_WGT
 -0.0208978 0.0308323 0.12162 -0.00225777 0.15124 0.013424 -0.186584 0.779178 0.998196  ;    BSV_LBW
 -0.0101462 0.0249047 0.195432 0.0214051 0.161476 0.00248157 -0.635002 0.517089 0.642687 0.997764  ;   BSV_CRCO
 0.0120646 -0.0423251 -0.172319 -0.0111109 -0.209915 -0.0420932 0.138918 -0.359699 -0.800989 -0.505722 0.998171  ;    BSV_SEX
$SIGMA  0.958797
$SIGMA  1e-07  FIX  ;     EPSCOV
$ESTIMATION METHOD=COND INTERACTION
$COVARIANCE PRINT=R UNCONDITIONAL


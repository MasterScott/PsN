; Model desc: moxodine + dummy covariates
$PROBLEM    MOXONIDINE PK,FINAL ESTIMATES,ALL DATA
;;

$INPUT      ID VISI XAT2=DROP DGRP=DROP DOSE=DROP FLAG=DROP ONO=DROP
            XIME=DROP DVO=DROP NEUY SCR AGE SEX NYH=DROP WT DROP ACE
            DIG DIU NUMB=DROP TAD TIME VIDD=DROP CRCL AMT SS II DROP
            CMT=DROP CONO=DROP DV EVID=DROP OVID=DROP DROP SHR2=DROP
            NYHA
$DATA       mx19.csv IGNORE=@
$SUBROUTINE ADVAN2 TRANS1
$OMEGA  BLOCK(2)
 0.075025050609
0.04674378248  0.056353354557  ; IIV (CL-V)
$OMEGA  BLOCK(1)
2.818016145  ;     IIV KA
$OMEGA  BLOCK(1)
 0.014703313679  ;     IOV CL
$OMEGA  BLOCK(1) SAME

$OMEGA  BLOCK(1)
 0.50629430171 ;     IOV KA
$OMEGA  BLOCK(1) SAME

$PK
;-----------OCCASIONS----------
   VIS3               = 0
   IF(VISI.EQ.3) VIS3 = 1
   VIS8               = 0
   IF(VISI.EQ.8) VIS8 = 1

;----------IOV--------------------
   
   KPCL  = VIS3*ETA(4)+VIS8*ETA(5)
   KPKA  = VIS3*ETA(6)+VIS8*ETA(7)

;---------- PK model ------------------

   TVCL  = THETA(1)
   TVV   = THETA(2)

   CL    = TVCL*EXP(ETA(1)+KPCL)
   V     = TVV*EXP(ETA(2))
   KA    = THETA(3)*EXP(ETA(3)+KPKA)
   ALAG1 = THETA(4)
   K     = CL/V
   S2    = V
;;;SCM-LINEARIZE_CONSTANTS
OGZ_CL=1
OGK_CL=1/1
$ERROR

     IPRED = LOG(.025)
     WA     = 1
     W      = WA
     IF(F.GT.0) IPRED = LOG(F)
     IRES  = IPRED-DV
     IWRES = IRES/W
     Y     = IPRED+ERR(1)*W

$THETA  (0,26.1) ; TVCL
$THETA  (0,100) ; TVV
$THETA  (0,4.5) ; TVKA
$THETA  (0,0.2149) ; LAG
;$THETA  (0,0.331) ; RES ERR
$SIGMA  0.10923047535
$ESTIMATION METHOD=1 MAXEVALS=9999     FORMAT=s1PE20.10

$TABLE ID TIME IPRED IWRES CWRES NOPRINT ONEHEADER FILE=sdtab4
$TABLE ID AGE WT SEX NOPRINT NOAPPEND ONEHEADER FILE=cotab4
$TABLE ID ACE DIG DIU SEX NYHA NOPRINT NOAPPEND ONEHEADER FILE=catab4


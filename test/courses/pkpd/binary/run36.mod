$PROB MEM Binary Data analysis, Bseline model

$INPUT ID TIME ODV DOSE ICL IV IKA 
       TYPE SMAX DV=SMXH THR CAV CAVH CON   
       ;CNT CNT2 CNT3 HC HC2 HC3 FE EVID 
       ;ETA1 ETA2 ETA3 ETA4 

$DATA data.csv IGNORE=@ ACCEPT=(THR.GT.0)

$PRED
  TVBASE = THETA(1)
  LP    = LOG(TVBASE/(1-TVBASE)) + ETA(1)
  PROB   = EXP(LP)/(1+EXP(LP))

  ; for simulation   
  IF(ICALL.EQ.4) THEN
    CALL RANDOM (2,R)
    DV=2
    RDV=1
    IF(R.GT.PROB) DV=0
    IF(R.GT.PROB) RDV=0
  ENDIF

  IF(DV.GT.1) THEN
    Y=PROB
    RDV = 1  ; the "real" DV
  ENDIF
  IF(DV.LE.1) THEN 
    Y=1-PROB
    RDV = 0  ; the "real" DV
  ENDIF

$THETA (0,0.8)     ;1 BASE
$OMEGA 0.1         ;1 BSV_BASE_logit

;Sim_start for VPC
;$SIM (12345) (678910 UNI) ONLY NOP NSUB=100 ; for VPC
$ESTIM MAXEVAL=9999 METHOD=COND LAPLACE LIKE PRINT=1 MSFO=msfb1
$COV PRINT=E
;Sim_end for VPC

$TABLE ID TIME RDV NOPRINT ONEHEADER FILE=sdtab36
$TABLE ID CAV CAVH CON NOPRINT ONEHEADER FILE=cotab36
$TABLE ID DOSE NOPRINT ONEHEADER FILE=catab36
$TABLE ID ICL IV IKA NOPRINT ONEHEADER FILE=patab36

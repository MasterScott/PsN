This is a list of the known bugs in PsN 4.4.0 at the time of the next public 
release (4.4.8 September 2015)



* The parameter labels in a raw results file used as input to PsN must be unique. If two parameters have the same label in a raw results file that PsN uses in e.g. sir, vpc or sse, PsN will crash during reading of the raw results file. 

* boot_scm will crash if valid_states is not supplied. Workaround is to supply valid_states in the .scm file. The default values that should have been can be found in the scm userguide.

* boot_scm will crash if scm option -time_varying is used. No workaround.

* scm option -foce, which only applies to linearized scm (option -linearize), must not be changed from its default value, or the scm will crash.

* The following bug has been in PsN at least since 3.7.6: Reading of data files which, excluding any header, contain a mix of comma,  space and/or tabs, or multiple tabs, as separator between values.  PsN will handle many sequences the same way as NONMEM,  for example <value><comma><space><value>, <value><comma><comma><value>,   <value><tab><value> and <value><space><space><value>, but not for example   <value><space><comma><value>, <value><tab><tab><value> or   <value><comma><tab><value>.  
"Handle the same way as NONMEM" in this context means inserting the same   number of missing values in a particular sequence of separators. NONMEM 7.3 will insert a missing value in <tab><tab>, <space><tab>, <comma><comma>,   <tab><comma> and <comma><tab>, but NONMEM will not insert a missing value  in <tab><space>, <space><comma>, <comma><space> or <space><space>. 
This bug can cause errors for programs that read the data file AND where the unhandled combination of column separators appears before (to the left of)  the column(s) used by PsN. For example, execute is not affected because execute   does not parse the dataset. But bootstrap can be affected if option -stratify_on is used AND the stratification column comes after the problematic separators, possibly leading to stratification being based on the wrong value. Scm can  also be affected if the data filtering step is not run AND the unhandled combination  appears before the covariate column(s), leading to the wrong min, max and median  computed for that covariate.

* A linearized scm (option -linearize) must not be run with an input model that has METHOD=ZERO.

* When record $ETAS or $PHIS is used with option FILE, PsN will not automatically copy the phi-file down to the NM_run directory where NONMEM is run. The user must either use option -extra_files to make PsN copy the file down to NM_run, or write the file name with a relative path that will be correct for a control stream copy in the NM_run subdirectory.

* bug in reading ofv from ext-files for NONMEM 7.2 and 7.3 for $PROBLEMs where $SIM is followed by at least two $EST where the last $EST has MAXEVAL=0 and at least one previous $EST does not have MAXEVAL=0. This bug is also in 4.2.0 and 3.7.6.

* bug for vpc when option -flip_comments is used in combination with $DATA where the data filename is enclosed by quotes, this will make vpc crash. The workaround is to not have quotes around the data filename when vpc is run with option -flip_comments. This bug is also in 4.2.0.

* bug in reading ofv from ext-files from NONMEM version 7.1.2 when control stream has more than one $PROBLEM in combination with $EST MAXEVAL=0. Such control streams are auto-generated by sir, and by -dofv procedure of bootstrap. This bug is also in 4.2.0 and 3.7.6. The workaround for sir when using NONMEM 7.1.2 is to set option -problems_per_file=1. The workaround for bootstrap when using option -dofv in combination with NONMEM 7.1.2 is to set -nm_output=cov,cor,coi,phi (i.e. excluding ext).

* If mcmp option -significance_level is set to 0.1 then mcmp will crash. No workaround. Set -significance_level=1 instead, and then check 0.1 output which is written in mcmp_results.csv. This bug is also in version 4.2.0. 

* scm bug in data filtration step that causes scm to crash. The bug is triggered when data filtration is run and $INPUT has DROP/SKIP items listed with NAME=DROP or NAME=SKIP instead of just DROP or SKIP without the data item name. The data filtration step is run when either -time_varying is set or $DATA has IGNORE=(<list>). The workaround is to either make sure data filtration is not triggered, or to set DROP or SKIP items without the data item name.

* vpc bug in reported 95% confidence interval for the median percentage of missing observations (option -censor) for bins where one or more simulated datasets has all the observations in that bin missing. The reported medians are correct, but the more simulations that have all observations in that bin censored, the more off the reported 95% confidence interval is. No workaround. This bug has been in PsN since version 3.4.2.

* If $DATA has an IGNORE=(<list>) statement where the list is split over two or more lines, i.e. opening and closing parentheses are on different lines, PsN may fail to parse $DATA correctly. The workaouround is to always have opening and closing parentheses on the same line in $DATA. This bug is also in version 4.2.0.

* If NONMEM version 6 is used the subversion number (1 or 2) must not be included in the [nm_versions] section in psn.conf, or PsN will fail to find the nmfe script. 

* When running the standalone update_inits script, final estimates read from output are first rounded to six decimals, and then the result is truncated to eight characters. This can lead to the last digit being wrong by one if the value is negative or the absolute value is >= 10. For example -0.206319 (nine characters) is truncated to -0.20631 instead of rounded to -0.20632. Value 1.123456789 will however be correctly rounded to 1.123457. This bug does *not* affect updating of initial estimates when part of a script that runs NONMEM, for example bootstrap or vpc, provided that NONMEM 7 is used. Rounding can be wrong also for bootstrap if NONMEM 6 is used. This bug is in version 4.2.0 as well, but not in 3.7.6.

* The following bug is avoided if option nm_output includes ext,cov,cor,coi as for example in the automatically generated psn.conf created by the installation script, where section [default_options] has the line

nm_output=ext,cov,cor,coi,phi 

If option -nm_output is not set to not include ext,cov,cor,coi, either in psn.conf or on the command-line, meaning that files .cor, .cov and/or .coi are not available when PsN reads NONMEM output, then the bug is triggered. When PsN must read the correlation, covariance and inverse covariance matrices from the lst-file, then those matrices will not be parsed correctly *if* $OMEGA and/or $SIGMA has either at least one block of at least size 3, or two or more blocks of at least size 2. This incorrect parsing will in turn lead to for example incorrect relative standard errors being reported by sumo and incorrect PDF weighting by sir for row 2 and higher for $OMEGA and $SIGMA. This bug has been in PsN since version 3.1.0 when support for NONMEM 7 was first introduced. The bug affects row2+ values for omega/sigma reported by sumo and sir (at least).  

* sumo message "No large standard errors found" cannot be trusted, there may be large standard errors that sumo fails to report. Any large standard errors that are reported can be trusted, but there may be additional ones that are missed by sumo. In other words: there are false negatives but no false positives. This bug has been in PsN for a long time, the same error is in versions 4.2.0 and 3.7.6 (and possibly earlier versions as well).

* sumo message "Correlations" will say "OK" even if there are large values in the correlation matrix. This bug has been in PsN for a long time, the same error is in versions 4.2.0 and 3.7.6 (and possibly earlier versions as well). 

* vpc binning with options -bin_by_count=1 and -bin_array=... in combination does not work (vpc will crash). Workaround: To get a specific binning use option combination -bin_by_count=0 -bin_array=... instead. This bug is not in PsN version 4.2.0.

* PsN will not recognize file extensions cpu or shm or agh in option -nm_output, files with those extensions will be ignored. It is possible to use option -extra_output to get these files copied back to the calling directory, but then they will have the generic names psn.cpu, psn.shm and psn.agh. This bug is in version 4.2.0 as well.

* vpc option -tte does not work in combination with options -sim_table and -orig_table.

* sumo will not display the correlation between ETAs for which the product of the variances (diagonal OMEGA elements) is less than or equal to 0.00001. Workaround: running sumo with option -ci will make sumo display the untransformed omega estimates, with confidence intervals. This bug is also in 4.2.0

* Data values with more than five significant digits in sse
The simulated datasets used in sse are \$TABLE output from NONMEM, and NONMEM rounds off values when printing tables. In NONMEM 6 1013201 is rounded to 1013200 (five significant digits), and if this makes a significant change to the model estimation, for example if the value is a covariate, then the sse results will be wrong. In NONMEM7 it is possible to set the FORMAT option in $TABLE to make sure no important information is lost. With NONMEM 6 the user must make sure the rounding to five significant digits does not harm the results.

* Lower case user defined and reserved words
Starting with NONMEM 7.2 lower case user defined and reserved words are supported. This is not supported
by PsN. For example in $INPUT all reserved words have to be upper case.
